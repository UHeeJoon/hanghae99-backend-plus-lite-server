# 콘서트 좌석 예약 시스템 요구사항 명세서

> 콘서트 예약 시스템의 기능 요구사항 및 비기능 요구사항을 정의하며, 향후 개발, 테스트, 운영의 기준을 제공한다.

---

## 📌 시스템 개요

- 사용자는 콘서트 좌석 예약을 위해 **대기열을 통과**하고, **잔액을 충전**한 뒤 좌석을 **예약 및 결제**할 수 있다.
- 좌석은 임시 배정 시간(5분) 동안 **다른 사용자에게 할당 불가**하다.
- 대기열을 기반으로 한 **공정한 접근 제어**가 보장되어야 하며, **동시성 제어와 확장성**을 고려하여 구현되어야 한다.

---

## 📘 용어 정의

| 용어     | 정의                                                                |
|--------|-------------------------------------------------------------------|
| 대기열 토큰 | 유저의 대기 순서와 예약 권한을 포함한 JWT 형식의 인증 토큰                               |
| 임시 배정  | 좌석이 일정 시간(예: 5분) 동안 특정 유저에게만 점유되는 상태 (미결제 시 만료됨)                  |
| 좌석 상태  | 좌석은 AVAILABLE(예약 가능) / HELD(예약 중) / RESERVED(예약 완료) 중 하나의 상태를 가진다 |

---

## ✅ 기능 요구사항

| ID | 기능명         | 설명                                                           |
|----|-------------|--------------------------------------------------------------|
| 01 | 대기열 토큰 발급   | 유저는 예약 서비스를 이용하기 위해 대기열에 진입하고 토큰을 발급받아야 한다.                  |
| 02 | 예약 가능 날짜 조회 | 유저는 예약 가능한 콘서트 날짜 목록을 조회할 수 있어야 한다.                          |
| 03 | 좌석 목록 조회    | 유저는 특정 날짜에 예약 가능한 좌석의 목록과 상태를 확인할 수 있어야 한다.                  |
| 04 | 좌석 예약 요청    | 유저는 특정 날짜와 좌석 번호를 지정하여 임시 배정 요청을 할 수 있어야 하며, 좌석은 일정 시간 점유된다. |
| 05 | 잔액 충전       | 유저는 본인의 계정에 금액을 충전할 수 있어야 하며, 음수 또는 0 금액은 거부되어야 한다.          |
| 06 | 잔액 조회       | 유저는 자신의 현재 잔액을 조회할 수 있어야 한다.                                 |
| 07 | 결제 처리       | 유저는 임시 배정된 좌석을 결제하여 소유권을 확정하고, 토큰은 만료 처리되어야 한다.              |

---

## 🚧 비기능 요구사항

| ID | 요구사항   | 설명                                                             |
|----|--------|----------------------------------------------------------------|
| 01 | 동시성 제어 | 동시에 여러 유저가 동일 좌석에 접근할 경우, 하나의 요청만 성공하고 나머지는 실패해야 한다. (Lock 적용) |
| 02 | 확장성    | 시스템은 다수의 인스턴스에서 동작할 수 있으며, 일관성 있는 상태 유지가 가능해야 한다. (Redis 등 활용) |
| 03 | 보안     | 토큰의 위변조를 방지해야 하며, HTTPS 통신이 필수다.                               |
| 04 | 장애 대응  | 토큰 또는 임시 배정 만료가 제대로 되지 않은 경우를 대비한 복구 메커니즘이 포함되어야 한다.           |

---

## 📎 제약사항

1. 예약 좌석은 결제가 완료된 경우에만 소유권이 확정된다.
2. 좌석 임시 배정 시간은 **5분**으로 설정되며, 만료 시 자동으로 반환된다.
3. 모든 API는 유효한 대기열 토큰을 요구한다 (인증 필수).

---